# Formal Methods From Scratch

*Formal Methods* are mathematical techniques a computer scientist can use to
better understand the systems she works with.
For example, she can apply these techniques to find errors in her design or
to rule out the possilibility that an error exists altogether.
By doing so, she can have greater confidence that the systems she designs are
reliable.

In this text, I will start with introductory material and work up to more
advanced techniques that are used in formal methods.

## Describing System Configurations

When thinking about a computer system, I often find it convenient to imagine
the system as a large machine with many interconnected parts.
A large machine will inevitably have *many* different possible
configurations. For example, imagine two connected gears. We might describe
the different possible configurations of the gears by showing how their
teeth interact.

A large part of formal methods is concerned with *mathematically* describing
the different possible configurations of a system.
If we can successfully describe the different configurations of a system and
we have an error we would like to check for, then we can **(1)** describe the
error as a problematic configuration of the system and **(2)** check if the
problematic configuration is part of our overall description.
If it *is* a part of our description, then we have made a mistake in our
design.
If it is not, then we can be confident that this problematic configuration is
impossible.

## Sets

Before we start describing machines, we need an introduction to a mathematical
topic called set theory. The reason we need to do this is because we will talk
about the various configurations of our systems as *sets* of configurations.

A *set* is a collection of distinct objects.
For example, $\{cat, dog, 4\}$ is a set of size $3$.
$\{cat, cat, dog\}$ is not a set, since $cat$ occurs twice (so not all objects
are distinct).
Sets are *unordered*. So $\{cat, dog, 4\}$ is the same as
$\{dog, 4, cat\}$.
We say that $dog$ is a *member* of $\{dog, 4, cat\}$ since it appears in the
set. We write membership with the symbol $\in$: $dog \in \{dog, 4, cat\}$.
Lets make two sets and name them:
$$A = \{cat, dog, 4\}$$
$$B = \{4, pawn, Bulgaria\}$$
By the way, it can be convenient to think about sets using Venn Diagrams. Here
are $A$ and $B$ depicted as a Venn Diagram:

$$
\begin{tikzpicture}[scale=0.8]
\draw[thin](4,5) circle(3 and 1.5) node(A) {};
\draw[thin](8,5) circle(3 and 1.5) node(B) {};
\draw(4,7) node (C) {\textbf{A}};
\draw(3, 4.5) node (D) {dog};
\draw(3.5, 5.5) node (C) {cat};
\draw(6,5) node (E) {4};
\draw(8,7) node (C) {\textbf{B}};
\draw(8,5.5) node (C) {pawn};
\draw(8.5,4.5) node (D) {Bulgaria};
\begin{scope}
\clip(4,5) circle (3 and 1.5);
\clip(8,5) circle (3 and 1.5);
\end{scope}
\end{tikzpicture}
$$

### Set Operations
There are some interesting operations for putting these sets together:
The first operation makes a new set from all elements in two other sets.
We call this the *union* of the two sets.
We write the union of $A$ and $B$ as $A \cup B$.
$$A \cup B = \{cat, dog, 4, pawn, Bulgaria\}$$
$$
\begin{tikzpicture}[scale=0.8]
\draw[very thick](4,5) circle(3 and 1.5) node(A) {};
\draw[very thick](8,5) circle(3 and 1.5) node(B) {};
\draw[fill=white,draw=none](4,5)circle(3 and 1.5);
\draw[fill=white,draw=none](8,5)circle(3 and 1.5);
\draw[draw=black!20](4,5) circle(3 and 1.5) node(A) {};
\draw[draw=black!20](8,5) circle(3 and 1.5) node(B) {};
\draw(6,7) node (C) {\textbf{A $\cup$ B}};
\draw(3, 4.5) node (D) {dog};
\draw(3.5, 5.5) node (C) {cat};
\draw(6,5) node (E) {4};
\draw(8,5.5) node (C) {pawn};
\draw(8.5,4.5) node (D) {Bulgaria};
\end{tikzpicture}
$$
The second operation makes a new set from the *common* elements in the other
two sets. We call this the *intersection* of the two sets.
We write the intersection of $A$ and $B$ as $A \cap B$.
$$A \cap B = \{4\}$$
$$
\begin{tikzpicture}[scale=0.8]
\draw[draw=black!20](4,5) circle(3 and 1.5) node(A) {};
\draw[draw=black!20](8,5) circle(3 and 1.5) node(B) {};
\draw(6,7) node (C) {\textbf{A $\cap$ B}};
\draw(3, 4.5) node (D) {dog};
\draw(3.5, 5.5) node (C) {cat};
\draw(6,5) node (E) {4};
\draw(8,5.5) node (C) {pawn};
\draw(8.5,4.5) node (D) {Bulgaria};
\begin{scope}
\clip(4,5) circle (3 and 1.5);
\clip(8,5) circle (3 and 1.5);
\draw[very thick](4,5) circle(3 and 1.5) node(A) {};
\draw[very thick](8,5) circle(3 and 1.5) node(B) {};
\end{scope}
\end{tikzpicture}
$$

### Common Sets
A particularly noteworthy set is one that has no elements: The
*empty set*, which we write $\varnothing$.

> **Some Set Laws**:
> There are already some interesting things we can say about sets.
> For example, we know that the union of two sets creates a new set with all
> elements of both. And we know that $\varnothing$ has no elements. So the
> union of $\varnothing$ with any other set must be equal to the other set!
> $$\forall x. x \cup \varnothing = x$$
> The symbol $\forall$ is read "for all". One reading of the mathematical
> statement above is, "for each set $x$, the union of $x$ with the empty set is
> $x$. We call such a statement a *law*: A mathematical truth which is
> guaranteed to hold in the current context of discourse.
> There is another law we can state:
> $$\forall x. x \cap \varnothing = \varnothing$$
> Reason through why this is the case.
>
> One more observation: Since sets are unordered, the order in which we put
> them together with $\cup$ and $\cap$ does not matter:
> $$\forall x y. x \cup y = y \cup x$$
> $$\forall x y. x \cap y = y \cap x$$
> We call this ability to "flip the order" *commutativity*. You might recall
> that numbers have this property under addition and multiplication. Sets are
> *commutative* under set union and set intersection.

Let's talk about other noteworthy sets. The first is the set of *natural
numbers*, or all whole numbers starting from $0$. We call this set $\mathbb{N}$
and you can (start) writing it as $\{0, 1, 2, 3, ...\}$. But you could never
finish writing down the elements in the set because $\mathbb{N}$ has *infinite*
size. Another is all whole numbers (including the negative whole numbers) which
are called the *integers* and which we write $\mathbb{Z}$ (for the German word
Zahlen). There are also the numbers which can be written as fractions, called
the rational numbers, which are written as $\mathbb{Q}$ (for quotient).

### Subsets
Let's make an observation: Every integer is also rational! This is because you
can rewrite every integer as a fraction by dividing the integer by $1$: $7 =
\frac{7}{1}$. We can write this truth mathematically:
$$\forall x. x \in \mathbb{Z} \Rightarrow x \in \mathbb{Q}$$
The symbol $\Rightarrow$ is pronounced "implies". Here are two possible
readings of the above statement:

- For every $x$, the fact that $x$ is an integer implies that $x$ is rational.
- If a number is an integer then it is also rational.

The fact that membership in some set $A$ implies membership in another set $B$
means that $A$ is a *subset* of $B$, which we write $A \subseteq B$.

You can imagine a subset as being inside its *superset*. So if $A$
is a subset of $B$, you could depict their relationship like this:
$$
\begin{tikzpicture}[scale=0.8]
\draw(0,-0.25) circle(2 and 1) node(A) {};
\draw(0,0) circle(3 and 1.5) node(B) {};
\draw(0,-0.25) node (C) {\textbf{A}};
\draw(0,1.125) node (D) {\textbf{B}};
\end{tikzpicture}
$$

> **Some more Set Laws**:
> An interesting law of sets is that *every set is a subset of itself*.
> Remember that we defined subset by membership: If every element in one set is
> in a second, then the first is a subset of the second. This is certainly true
> if the two sets in question are the same!
> $$\forall a. a \subseteq a$$
> Another interesting fact is that since $\varnothing$ has no members, it is
> automatically a subset of every other set:
> $$\forall a. \varnothing \subseteq a$$
> Try stating an English interpretation of these laws.

Sometimes, we want to say that a set $A$ is a subset of $B$, but not the same
set. We would then say that $A$ is a *strict subset* of $B$, and write $A
\subset B$. 

### Set Partitions

Perhaps the single key idea I would have a reader take away from this
discussion of sets is that of a *set partition*.
A set partition is a collection of distinct subsets whose union forms the
original set.
For example, $\{a, b, c\}$, $\{d, e\}$, and $\{f, g, h\}$ form a partition of
the set $\{a, b, c, d, e, f, g, h\}$. Note that no element is repeated across
the sets. This is what we mean by distinct: Two sets are distinct if and only
if their intersection is empty: $A \cap B = \varnothing$.

The idea of a partition is simple, but of great importance. It is critical for
us because in the next section, we will define *logical formulas*. One way to
view the meaning of a logical formula is that it creates a partition of size
two of some set.

In formal methods we use this partition to partition the set of potential
system configurations, separating those that are possible from those that are
impossible!

### Definitions
- A *set* is a collection of distinct objects.
- The *empty set* is the set with no elements, and is written $\varnothing$.
  $$\forall a. a \notin \varnothing$$
  (For every possible element, it is not the case that it is a member of the
  empty set).
- The *union* of a set $x$ and a set $y$ is the set $x \cup y$ such that each
  object that is a member of $x$ *or* a member of $y$ is also a member of $x \cup y$:
  $$\forall a x y. a \in x \vee a \in y \iff a \in x \cup y$$
- The *intersection* of a set $x$ and a set $y$ is the set $x \cap y$ such that
  each object that is a member of $x$ *and* a member of $y$ is also a member of
  $x \cap y$:
  $$\forall a x y. a \in x \wedge a \in y \iff a \in x \cap y$$
- A set is a *subset* of another if every element in the first appears in the second:
  $$\forall x y. (\forall a. a \in x \Rightarrow a \in y) \iff (x \subseteq y)$$
- A set is a *strict subset* of another if the first is a subset of the second
  and the two are not equal:
  $$\forall x y. (x \subseteq y \wedge x \neq y) \iff x \subset y$$
- A collection of subsets form a *partition* of another set if the intersection
  of each pair in the collection is the empty set and the union of all subsets
  forms the set.
